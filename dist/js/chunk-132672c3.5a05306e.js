(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-132672c3"],{"429c":function(e,t,n){"use strict";n("a411")},"6a96":function(e,t,n){"use strict";n("b0c0"),n("d3b7"),n("25f0"),n("498a");var i=n("3fa5"),o={emailChecker:function(e){var t=/^\w{3,}@\w{2,}\.(com|cn|net|com\.cn)$/;return 0!=t.test(e)||(i["a"].error("请输入格式正确的邮件地址!"),!1)},contentChecker:function(e){return e.trim().length>2},articleChecker:function(e){if(0==e.title.trim().length)i["a"].warn("请填写标题");else if(0==e.summary.trim().length)i["a"].warn("请填写内容");else if(""==e.categoryId)i["a"].warn("请选择分类");else if(0==e.pictureUrl.trim().length)i["a"].warn("请上传封面");else if(0==e.content.trim().length)i["a"].warn("请填写内容");else{if(0!=e.tagList.length)return!0;i["a"].warn("请选择标签")}return!1},categoryChecker:function(e){return 0!=e.name.trim().length||(i["a"].warn("请填写有效的分类名"),!1)},tagChecker:function(e){return 0!=e.name.trim().length||(i["a"].warn("请填写有效的标签名"),!1)},friendLinkChecker:function(e){if(0==e.name.trim().length)i["a"].warn("请填写有效的友链名称");else{if(0!=/(https?):\/\/[-A-Za-z0-9+&@#/%?=~_|!:,.;]+[-A-Za-z0-9+&@#/%=~_|]/.test(e.url.trim()))return!0;i["a"].warn("请填写有效的URL路径")}return!1},newsChecker:function(e){return 0!=e.content.toString().trim().length||(i["a"].warn("请填写内容"),!1)}};t["a"]=o},"86cc":function(e,t,n){"use strict";n.r(t);var i=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",[n("el-card",[n("h1",[e._v("随说列表")]),n("el-divider"),n("el-row",{staticClass:"table-button-container",attrs:{gutter:10}},[n("el-col",{attrs:{lg:{span:20}}},[n("el-button",{attrs:{type:"primary"},on:{click:function(t){e.news.content="",e.addDialogDisplay=!0}}},[e._v("添加")])],1),n("el-col",{attrs:{lg:{span:4}}},[n("el-input",{attrs:{placeholder:"请输入关键字"},on:{change:function(t){return e.getNewsList(1)}},model:{value:e.searchValue,callback:function(t){e.searchValue=t},expression:"searchValue"}})],1)],1),n("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.newsListLoading,expression:"newsListLoading"}],attrs:{data:e.newsList,stripe:"",border:""},on:{"sort-change":e.orderList}},[n("el-table-column",{attrs:{type:"expand"},scopedSlots:e._u([{key:"default",fn:function(t){return[n("div",{staticClass:"article-content ck-content",domProps:{innerHTML:e._s(t.row.content)}})]}}])}),n("el-table-column",{attrs:{label:"id",sortable:"custom",prop:"id",width:"100",align:"center"}}),n("el-table-column",{attrs:{label:"用户名",align:"center",prop:"username"}}),n("el-table-column",{attrs:{label:"创建时间",sortable:"custom",prop:"createBy",align:"center"}}),n("el-table-column",{attrs:{align:"center",label:"操作"},scopedSlots:e._u([{key:"default",fn:function(t){return[n("el-button",{attrs:{size:"small"},on:{click:function(n){e.updateDialogDisplay=!0,e.news.id=t.row.id,e.news.content=t.row.content}}},[e._v("编辑")]),n("el-button",{staticClass:"el-button--danger",attrs:{size:"small"},on:{click:function(n){return e.deleteNews(t.row.id)}}},[e._v("删除")])]}}])})],1)],1),n("el-pagination",{attrs:{total:e.total,"current-page":e.pageNum,"page-size":e.pageSize},on:{"current-change":e.getNewsList}}),n("el-dialog",{attrs:{visible:e.addDialogDisplay,"close-on-click-modal":!1,width:"50%",title:"添加新随说"},on:{"update:visible":function(t){e.addDialogDisplay=t}}},[n("el-form",{staticStyle:{"text-align":"center"},model:{value:e.news,callback:function(t){e.news=t},expression:"news"}},[n("el-form-item",{attrs:{label:"内容"}},[n("ckeditor",{attrs:{editor:e.editor,config:e.editorConfig},model:{value:e.news.content,callback:function(t){e.$set(e.news,"content",t)},expression:"news.content"}})],1),n("el-form-item",[n("el-button",{staticClass:"el-button--primary",on:{click:e.submitAdd}},[e._v("提交")]),n("el-button",{on:{click:function(t){e.addDialogDisplay=!1}}},[e._v("取消")])],1)],1)],1),n("el-dialog",{attrs:{visible:e.updateDialogDisplay,"close-on-click-modal":!1,width:"50%",title:"修改随说"},on:{"update:visible":function(t){e.updateDialogDisplay=t}}},[n("el-form",{staticStyle:{"text-align":"center"},model:{value:e.news,callback:function(t){e.news=t},expression:"news"}},[n("el-form-item",[n("ckeditor",{attrs:{editor:e.editor,config:e.editorConfig},model:{value:e.news.content,callback:function(t){e.$set(e.news,"content",t)},expression:"news.content"}})],1),n("el-form-item",[n("el-button",{staticClass:"el-button--primary",on:{click:e.submitUpdate}},[e._v("提交")]),n("el-button",{on:{click:function(t){e.updateDialogDisplay=!1}}},[e._v("取消")])],1)],1)],1)],1)},o=[],a=n("3730"),r=n.n(a),s=n("fb3d"),l=n.n(s),c=n("30a6"),u=(n("4160"),n("d3b7"),n("159b"),n("1c42")),d=n("3fa5"),f=n("124d"),m={deleteNews:function(e,t){return null!=e?new Promise((function(n,i){var o="/admin/news?id="+t;u["a"].delete(o,{headers:{Authorization:e}}).then((function(){d["a"].success("删除随说成功!"),n()}),(function(e){return i(e)}))})):Promise.reject("no token")},updateNews:function(e,t){return null!=e?(t.content=f["a"].imageRemoveProxy(t.content),new Promise((function(n,i){var o="/admin/news";u["a"].put(o,t,{headers:{Authorization:e}}).then((function(){d["a"].success("更新随说成功!"),n()}),(function(e){return i(e)}))}))):Promise.reject("no token")},addNews:function(e,t){return null!=e?(t.content=f["a"].imageRemoveProxy(t.content),new Promise((function(n,i){var o="/admin/news";u["a"].post(o,t,{headers:{Authorization:e}}).then((function(){d["a"].success("新增随说成功!"),n()}),(function(e){return i(e)}))}))):Promise.reject("no token")},getNewsList:function(e,t,n,i,o,a){return null!=e?new Promise((function(r,s){var l="/admin/news/list?pageNum="+t+"&pageSize="+n+"&searchValue="+i+"&orderProperty="+o+"&orderDirection="+a;u["a"].get(l,{headers:{Authorization:e}}).then((function(e){e.list.forEach((function(e){e.content=f["a"].imageAddProxy(e.content)})),r(e)}),(function(e){return s(e)}))})):Promise.reject("no token")}},g=m,p=n("90fb"),h=n("6a96"),w={name:"NewsList",data:function(){return{searchValue:"",newsListLoading:!0,newsList:[],orderDirection:"desc",orderProperty:"create_by",pageSize:5,pageNum:1,total:0,news:{id:0,content:""},addDialogDisplay:!1,updateDialogDisplay:!1,editor:l.a,editorConfig:{image:{toolbar:["imageTextAlternative","imageStyle:full","imageStyle:side"]},table:{contentToolbar:["tableColumn","tableRow","mergeTableCells","tableCellProperties","tableProperties"]},toolbar:{items:["undo","redo","|","bold","italic","underline","strikethrough","subscript","superscript","removeFormat","|","fontSize","fontFamily","fontColor","fontBackgroundColor","highlight","|","link","bulletedList","numberedList","|","alignment","indent","outdent","horizontalLine","|","imageUpload","blockQuote","insertTable","code","codeBlock","todoList"]},simpleUpload:{uploadUrl:p["a"]+"/admin/upload/images",headers:{Authorization:"",baseURL:p["a"]}}}}},components:{ckeditor:r.a.component},methods:{submitAdd:function(){var e=this;h["a"].newsChecker(this.news)&&g.addNews(this.token,this.news).then((function(){e.addDialogDisplay=!1,e.getNewsList(e.pageNum)}),(function(e){return console.error(e)}))},submitUpdate:function(){var e=this;h["a"].newsChecker(this.news)&&g.updateNews(this.token,this.news).then((function(){e.updateDialogDisplay=!1,e.getNewsList(e.pageNum)}),(function(e){return console.error(e)}))},deleteNews:function(e){var t=this;this.$confirm("此操作将会删除id:"+e+"的随说,并且无法恢复!","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){g.deleteNews(t.token,e).then((function(){t.getNewsList(t.pageNum)}),(function(e){return console.error(e)}))})).catch((function(){}))},orderList:function(e){this.pageNum=1,this.orderProperty=e.prop,this.orderDirection=e.order,this.getNewsList(1)},getNewsList:function(e){var t=this;this.newsListLoading=!0,g.getNewsList(this.token,e,this.pageSize,this.searchValue,this.orderProperty,this.orderDirection).then((function(n){t.newsList=n.list,t.pageNum=e,t.total=n.total,t.newsListLoading=!1}),(function(e){return console.error(e)}))},getToken:function(){var e=this.$cookies.get(c["a"].admin);null==e?this.$router.push("/admin/login"):(this.token=e,this.editorConfig.simpleUpload.headers.Authorization=e)}},created:function(){this.getToken(),this.getNewsList(1)}},b=w,k=(n("429c"),n("2877")),v=Object(k["a"])(b,i,o,!1,null,"69f5887e",null);t["default"]=v.exports},a411:function(e,t,n){},b0c0:function(e,t,n){var i=n("83ab"),o=n("9bf2").f,a=Function.prototype,r=a.toString,s=/^\s*function ([^ (]*)/,l="name";i&&!(l in a)&&o(a,l,{configurable:!0,get:function(){try{return r.call(this).match(s)[1]}catch(e){return""}}})}}]);